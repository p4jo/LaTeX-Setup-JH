% ignored on option omitExternalPackages

% xspace
\xspaceaddexceptions{“ "-}

% interval
% \intervalconfig{soft open fences} %kann man verwenden, um Intervalle (a,b] zu erzeugen
% \intervalconfig{separator symbol=;} %kann man verwenden, um Intervalle ]a;b] zu erzeugen

% siunitx
\sisetup
{
	detect-all, %Alle äußeren Font-Veränderungen werden übernommen
	locale=DE, %insb. , statt .
	range-phrase={\ bis\ }, %in \SIrange
	separate-uncertainty=true, % (1,32 \pm 0, 22) statt 1,32(22) in Ausgabe
	%table-figures-uncertainty = 1, % reserves space for one \pm sign (use as \tabular{S[tab..]})
	% EITHER
		% per-mode=symbol-or-fraction,
	% OR
		per-mode=fraction, %
		fraction-function=\sfrac,
	% ENDEITHER
	% round-integer-to-decimal=true,
	% quotient-mode=fraction, % Option wurde entfernt
	% literal-superscript-as-power=true % Option nicht mehr notwendig
}

% \shorthandoff{"} % Würde normalerweise "a zu ä machen.
\AfterEndPreamble{
    \shorthandoff{"}
}

% hyperref
\hypersetup
{
	colorlinks	= true,
	linkcolor   = Links, 
	citecolor   = Links,
	% bookmarksnumbered = true,
	urlcolor    = Links,
	pdfauthor   = {\JHPreamble@author},
	pdftitle    = {\JHPreamble@title}%,
	% pdfsubject  = {<set this yourself using \hypersetup>},
	% pdfkeywords = {<same>}
}

% lstlisting

\lstset{
    basicstyle=\scriptsize\codeFont,
    keywordstyle=\bfseries\color{lila},
    emphstyle=\color{dunkelrot},
    stringstyle=\color{dunkelgrün},
    commentstyle=\color{dunkelgrau},
    identifierstyle=\color{dunkelblau},
    numbers=left,
    stepnumber=5,
    frame=tb,
    showstringspaces=false,
    showspaces=false,
    showtabs=false,
    breaklines=true,
    tabsize=2
}

\lstdefinelanguage
    [JH]{Python} % dialect JH of Python
    []{Python} % based on standard dialect of Python
{
    morekeywords={self,True,False,as,assert},           
    emph={__init__,__str__,__repr__,\#\#\#\#\#\#\#}
}

% tensind
% \tensordelimiter{§} % Funktioniert nicht, da unicode-math so normale Zeichen überschreibt, auf eine Art und Weise, die tensind nicht überschreibt
\tensordelimiter{￭}
\tensorformat{}

% \hyphenation{Hoch-tem-pera-tur-su-pra-lei-tern Ku-pfer-atomen}


\usepackage{amsthm}
\usepackage{thmtools}

\declaretheoremstyle[
    bodyfont=\upshape,
    headfont={\sffamily\bfseries},
    notefont={\sffamily\bfseries},
    headpunct={:},
]{JHDefinition}

\declaretheoremstyle[
    bodyfont={\color{dunkelgrau}},
    headpunct={:},
    headfont={\itshape},
    notefont={\itshape}
]{JHProof}

% Bemerkung mit Rahmen
\declaretheoremstyle[
    bodyfont={\upshape},
    headfont={\hspace{-11pt} \itshape}, %\itshape
    notefont=\itshape,
    headpunct={:}
]{JHRemark}

\cs_if_exist:NTF\chapter{
    \newcommand\__numberwithin{chapter}
}{
    \newcommand\__numberwithin{section}
}
\declaretheorem[
    style=JHDefinition,
    shaded={
        bgcolor=hellgrün
    },
    numberwithin=\__numberwithin
]{Satz}
\declaretheorem[
    style=JHDefinition,
    shaded={
        bgcolor=hellgrün
    },
    numberlike=Satz
]{Lemma}
\declaretheorem[
    style=JHDefinition,
    shaded={
        bgcolor=hellgrau
    },
    numberlike=Satz
]{Korollar}

% numbered like Definition
\ifJHPreamble@NumberDefLikeSatz
    \declaretheorem[
        style=JHDefinition,
        shaded={
            bgcolor=blasshellblau
        },
        numberlike=Satz
    ]{Definition}
\else
    \declaretheorem[
        style=JHDefinition,
        shaded={
            bgcolor=blasshellblau
        },
        numberwithin=\__numberwithin
    ]{Definition}
\fi
\declaretheorem[
    style=JHDefinition,
    shaded={
        bgcolor=blasstürkis
    },
    name=Definierendes\ Lemma,
    refname=definierenden\ Lemma,
    numberlike=Definition
]{DefLemma}

% not numbered
\declaretheorem[
    style=JHRemark,
    numbered=no,
    name=Beispiel
]{beispiel}
\declaretheorem[
    style=JHProof,
    numbered=no
]{Beweis}

\declaretheorem[
    style=JHRemark,
    name=Bemerkung,
    numbered=no
]{bemerkung}

% \usepackage{mdframed}
% \surroundwithmdframed[
%     linewidth=1pt,
%     linecolor= dunkelgrau,
%     % roundcorner=1pt,
%     topline = false,
%     rightline = false,
%     bottomline = false,
%     rightmargin=0pt,
%     skipabove=0.1cm,
%     skipbelow=0pt,
%     leftmargin=1pt,
%     innerleftmargin=10pt,
%     innerrightmargin=0pt,
%     innertopmargin=-20pt,
%     innerbottommargin=0pt,
% ]{Bemerkung}

\usepackage[most]{tcolorbox}
\tcbuselibrary{skins}
\tcbuselibrary{breakable}
\newcommand\drawLeftLine[2][-8pt]{ % #2=the color
    \draw[line~width = 2pt, #2, opacity = 0.7]
        ([ shift = { (1pt, #1) } ] interior.north~west )
    -- ([ shift = { (1pt, 8pt) } ] interior.south~west );
}
\newtcolorbox{leftLineBox}[2][]{
    enhanced,
    empty,
    breakable=true,
    left=7pt,
    overlay={ \drawLeftLine[-25pt]{#2} },
    % code for the first part of a break sequence:
    skin~first~is~subskin~of = { emptyfirst }{ 
        overlay = {\drawLeftLine[-25pt]{#2} }
    },
    % code for the middle part of a break sequence:
    skin~middle~is~subskin~of = { emptymiddle }{
        overlay = { \drawLeftLine{#2} }
    },
    % code for the last part of a break sequence:
    skin~last~is~subskin~of = { emptylast }{
        overlay = { \drawLeftLine{#2} }
    },
    #1
}
\NewDocumentEnvironment{Bemerkung}{o D(){dunkelgrün}}{ 
    \begin{leftLineBox}{#2}
        \IfValueTF{#1}{
            \begin{bemerkung}[#1]
        }{
            \begin{bemerkung}            
        }
}{ 
    \end{bemerkung}
    \end{leftLineBox}
}

\NewDocumentEnvironment{Beispiel}{o D(){dunkelblau}}{ 
    \begin{leftLineBox}{#2}
        \IfValueTF{#1}{
            \begin{beispiel}[#1]
        }{
            \begin{beispiel}            
        }
}{ 
    \end{beispiel}
    \end{leftLineBox}
}